# GANs for financial series generation
<h2>Project team:</h2>

<h4>Riccardo Bollati</h4>

<h4>Elisa Carucci</h4>

<h4>Stefan Huber</h4>

# Aim of the progect:

The aim of the project is create a GAN capable of generating realistic financial time series. The folders of the projects have the functions:

- **data**: this folder contains all the dataset and the function to download new financial series and create dataset from them.
- **evaluate model**: this folder contains some functions that can be used to evaluate the series generated by the models, plotting some samples and the distribution of the series generated.
- **report**: this folder contains the pdf report that illustrates the aim of the progect and how the function used work.

# Download the data:

to donwload the data is possible to use the code contained in the folder "data". In the file real_data_gen.ipynb is possible to find all function to download the dataset from Yahoo, divide the series into windows and save them. The last function of the file clean the dataset to avoid any possible error due to windows len.

# Model Architechture

Regarding model choice, we opt for a Wasserstein GAN (WGAN) because of its strength in training stability and the fact that its loss directly correlates with the generatorâ€™s convergence. For the architecture of both generator and critic, we derive major inspiration from [Savasta & Politano(2020)](https://towardsdatascience.com/generating-synthetic-financial-time-series-with-wgans-e03596eb7185), but modify it to fit our needs:

1. The Generator is a convolutional network consisting of a sequence of convolutional, upsampling, and dropout layers followed by a linear transformation. The network applies a leaky ReLU activation function element-wise after each convolutional and linear layer, except for the final layer. The dimensions of the output are modified by applying an AddDimension and SqueezeDimension function. The network is initialized with Xavier uniform weight initialization.
2. The Critic is a convolutional network consisting of a sequence of convolutional, max pooling, and linear layers followed by a leaky ReLU activation function applied element-wise after each convolutional and linear layer. It applies spectral normalization to the output of each convolutional layer. The dimensions of the input are modified by applying an AddDimension function, and the output is flattened before the final linear layer. The final output is a single number that represents the prediction over the given sample, as fake of real.


# Results
the following plot illustrates some series, obtained after the scaling and application of the filter to a syntetic dataset generated by our model. The plots in the middle are the prices along with the returns that generated them on the left. The plots on the rights are the residuals obtained after a linear regression performed on the prices. The residuals plot can give some useful insights on how to tune the filter parameters based on our needs.

![syntetic series](results/results_plot_README.png)

The following plots shows some reale series from the dataset (white background) along with some from a fake dataset (gray background)

![series comparison](results/series_comparison_README.png)
